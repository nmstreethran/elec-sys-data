%%%
% Pandoc LaTeX template
% https://pandoc.org/demo/template.tex
% modified by nmstreethran at gmail dot com
%%%

\PassOptionsToPackage{unicode=true$for(hyperrefoptions)$,$hyperrefoptions$$endfor$}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
$if(colorlinks)$
    \PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
$endif$
$if(dir)$
    $if(latex-dir-rtl)$
        \PassOptionsToPackage{RTLdocument}{bidi}
    $endif$
$endif$

\documentclass[
    $if(fontsize)$
        $fontsize$,
    $endif$
    $if(lang)$
        $babel-lang$,
    $endif$
    $if(papersize)$
        $papersize$paper,
    $endif$
    $if(beamer)$
        ignorenonframetext,
        $if(handout)$
            handout,
        $endif$
        $if(aspectratio)$
            aspectratio=$aspectratio$,
        $endif$
    $endif$
    $for(classoption)$
        $classoption$$sep$,
    $endfor$
    ]{$documentclass$}

\usepackage[unicode]{hyperref}

$if(fontfamily)$
    \usepackage[$for(fontfamilyoptions)$$fontfamilyoptions$$sep$,$endfor$]{$fontfamily$}
$else$
    \usepackage{lmodern}
$endif$
$if(linestretch)$
    \usepackage{setspace}
    \setstretch{$linestretch$}
$endif$
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
    \usepackage[$if(fontenc)$$fontenc$$else$T1$endif$]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
    $if(mathspec)$
        \ifxetex
            \usepackage{ucs}
            \usepackage{mathspec}
            \usepackage[utf8x]{inputenc}
        \else
            \usepackage{unicode-math}
        \fi
    $else$
        \usepackage{unicode-math}
    $endif$
        \defaultfontfeatures{Scale=MatchLowercase}
        \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
    $if(mainfont)$
        \setmainfont[$for(mainfontoptions)$$mainfontoptions$$sep$,$endfor$]{$mainfont$}
    $endif$
    $if(sansfont)$
        \setsansfont[$for(sansfontoptions)$$sansfontoptions$$sep$,$endfor$]{$sansfont$}
    $endif$
    $if(monofont)$
        \setmonofont[$for(monofontoptions)$$monofontoptions$$sep$,$endfor$]{$monofont$}
    $endif$
    $for(fontfamilies)$
        \newfontfamily{$fontfamilies.name$}[$for(fontfamilies.options)$$fontfamilies.options$$sep$,$endfor$]{$fontfamilies.font$}
    $endfor$
    $if(mathfont)$
        $if(mathspec)$
            \ifxetex
                \setmathfont(Digits,Latin,Greek)[$for(mathfontoptions)$$mathfontoptions$$sep$,$endfor$]{$mathfont$}
            \else
                \setmathfont[$for(mathfontoptions)$$mathfontoptions$$sep$,$endfor$]{$mathfont$}
            \fi
        $else$
            \setmathfont[$for(mathfontoptions)$$mathfontoptions$$sep$,$endfor$]{$mathfont$}
        $endif$
    $endif$
\fi
% heading fonts
\usepackage{titlesec}
\titleformat*{\section}{\sffamily\LARGE\bfseries}
\titleformat*{\subsection}{\sffamily\Large\bfseries}
\titleformat*{\subsubsection}{\sffamily\large\bfseries}

%%% fancy settings were originally here - moved to geometry to fix margin issues %%%
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
    \usepackage[$for(microtypeoptions)$$microtypeoptions$$sep$,$endfor$]{microtype}
    \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
$if(indent)$
$else$
    \makeatletter
    \@ifundefined{KOMAClassName}{% if non-KOMA class
        \IfFileExists{parskip.sty}{%
            \usepackage{parskip}
        }{% else
            \setlength{\parindent}{0pt}
            \setlength{\parskip}{6pt plus 2pt minus 1pt}}
        }{% if KOMA class
            \KOMAoptions{parskip=half}}
    \makeatother
$endif$
$if(verbatim-in-note)$
    \usepackage{fancyvrb}
$endif$

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
% \usepackage{hyperxmp} %%% added hyperxmp for additional metadata
\hypersetup{
    $if(title-meta)$
        pdftitle={$title-meta$},
    $endif$
    $if(author-meta)$
        pdfauthor={$author-meta$},
    $endif$
    $if(keywords)$
        pdfkeywords={$for(keywords)$$keywords$$sep$, $endfor$},
    $endif$
    $if(subject)$
        pdfsubject={$subject$},
    $endif$
    $if(colorlinks)$
        colorlinks=true,
        linkcolor=$if(linkcolor)$$linkcolor$$else$Maroon$endif$,
        filecolor=$if(filecolor)$$filecolor$$else$Maroon$endif$,
        citecolor=$if(citecolor)$$citecolor$$else$Blue$endif$,
        urlcolor=$if(urlcolor)$$urlcolor$$else$Blue$endif$,
    $else$
        pdfborder={0 0 0},
    $endif$
    breaklinks=true}
% \urlstyle{same}  % don't use monospace font for urls
$if(verbatim-in-note)$
    \VerbatimFootnotes % allows verbatim text in footnotes
$endif$

$if(geometry)$
    \usepackage[$for(geometry)$$geometry$$sep$,$endfor$]{geometry}
$endif$
%%% moved fancy settings here - after geometry - to fix margin issues
\usepackage{fancyhdr}
\pagestyle{fancy}
%%%
\fancyhf{} % sets both header and footer to nothing
\renewcommand{\headrulewidth}{0pt} % remove horizontal line from header
\fancyfoot[LE,RO]{\thepage} % page number
\fancyhead[RE,LO]{\textit{$title$}}
%%%

\newcommand{\passthrough}[1]{#1}
\usepackage[nottoc,notbib]{tocbibind} % adding lists to the toc
$if(lhs)$
    \lstnewenvironment{code}{\lstset{language=Haskell,basicstyle=\small\ttfamily}}{}
$endif$
%%% disabled listings in favour of Pandoc's default use of the
%%% skylighting Haskell library for syntax highlighting
$if(highlighting-macros)$
    $highlighting-macros$
$endif$
%%% code formatting
\usepackage{xcolor}
% overwrite shade colour defined in template
\definecolor{shadecolor}{HTML}{FFF8DC}
% set background colour of inline code
\let\oldtexttt\texttt
\renewcommand{\texttt}[1]{
  \colorbox{shadecolor}{\oldtexttt{#1}}
}
%%%

$if(tables)$
    \usepackage{longtable,booktabs}
%%% table font size
    \let\oldtabular\longtable
    \renewcommand{\longtable}{\footnotesize\oldtabular}
%%%
    $if(beamer)$
        \usepackage{caption} %%%
        % These lines are needed to make table captions work with longtable:
        \makeatletter
        \def\fnum@table{\tablename~\thetable}
        \makeatother
    $else$
        \usepackage[font=small,labelfont=bf]{caption} %%% added
        % Allow footnotes in longtable head/foot
        \IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
        \makesavenoteenv{longtable}
    $endif$
$endif$
$if(graphics)$
    \usepackage{graphicx,grffile,tikz,tikzpagenodes}
    \usetikzlibrary{positioning}
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
    \def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
    \makeatother
    % Scale images if necessary, so that they will not overflow the page
    % margins by default, and it is still possible to overwrite the defaults
    % using explicit options in \includegraphics[width, height, ...]{}
    \setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
$endif$
$if(links-as-notes)$
    % Make links footnotes instead of hotlinks:
    \DeclareRobustCommand{\href}[2]{#2\footnote{\url{#1}}}
$endif$
$if(strikeout)$
    \usepackage[normalem]{ulem}
    % avoid problems with \sout in headers with hyperref:
    \pdfstringdefDisableCommands{\renewcommand{\sout}{}}
$endif$
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
$if(numbersections)$
    \setcounter{secnumdepth}{$if(secnumdepth)$$secnumdepth$$else$5$endif$}
$else$
    \setcounter{secnumdepth}{-2}
$endif$
$if(beamer)$
$else$
    $if(subparagraph)$
    $else$
    % Redefines (sub)paragraphs to behave more like sections
    \ifx\paragraph\undefined\else
        \let\oldparagraph\paragraph
        \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
    \fi
    \ifx\subparagraph\undefined\else
        \let\oldsubparagraph\subparagraph
        \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
    \fi
    $endif$
$endif$
$if(pagestyle)$
    \pagestyle{$pagestyle$}
$endif$
% set default figure placement to htbp
\makeatletter
\def\fps@figure{!htb} %%% modified
\makeatother
$for(header-includes)$
    $header-includes$
$endfor$

$if(lang)$
    \ifnum 0\ifxetex 1\fi=0 % if pdftex or luatex
        \usepackage[shorthands=off,$for(babel-otherlangs)$$babel-otherlangs$,$endfor$main=$babel-lang$]{babel}
        $if(babel-newcommands)$
            $babel-newcommands$
        $endif$
    \else % if xetex
    % load polyglossia as late as possible as it *could* call bidi if RTL lang (e.g. Hebrew or Arabic)
        \usepackage{polyglossia}
        \setmainlanguage[$polyglossia-lang.options$]{$polyglossia-lang.name$}
        $for(polyglossia-otherlangs)$
            \setotherlanguage[$polyglossia-otherlangs.options$]{$polyglossia-otherlangs.name$}
        $endfor$
    \fi
$endif$
$if(dir)$
    \ifxetex
        % load bidi as late as possible as it modifies e.g. graphicx
        \usepackage{bidi}
    \fi
    \ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
        \TeXXeTstate=1
        \newcommand{\RL}[1]{\beginR #1\endR}
        \newcommand{\LR}[1]{\beginL #1\endL}
        \newenvironment{RTL}{\beginR}{\endR}
        \newenvironment{LTR}{\beginL}{\endL}
    \fi
$endif$
$if(natbib)$
    \usepackage[$natbiboptions$]{natbib}
    \bibliographystyle{$if(biblio-style)$$biblio-style$$else$plainnat$endif$}
$endif$
$if(biblatex)$
    \usepackage[$if(biblio-style)$style=$biblio-style$,$endif$$for(biblatexoptions)$$biblatexoptions$$sep$,$endfor$]{biblatex}
    $for(bibliography)$
        \addbibresource{$bibliography$}
    $endfor$
$endif$

$if(title)$
    \title{$title$$if(thanks)$\thanks{$thanks$}$endif$}
$endif$
$if(subtitle)$
    $if(beamer)$
    $else$
        \usepackage{etoolbox}
        \makeatletter
        \providecommand{\subtitle}[1]{% add subtitle to \maketitle
            \apptocmd{\@title}{\par {\large #1 \par}}{}{}
        }
        \makeatother
    $endif$
    \subtitle{$subtitle$}
$endif$
$if(author)$
    \author{$for(author)$$author$$sep$ \and $endfor$}
$endif$
\date{$date$}
$if(beamer)$
    $if(institute)$
        \institute{$for(institute)$$institute$$sep$ \and $endfor$}
    $endif$
    $if(titlegraphic)$
        \titlegraphic{\includegraphics{$titlegraphic$}}
    $endif$
    $if(logo)$
        \logo{\includegraphics{$logo$}}
    $endif$
$endif$
$if(glossaries)$
    \usepackage[acronym,toc,nonumberlist,nopostdot,nogroupskip,style=index]{glossaries} % glossary for abbreviation
    \makenoidxglossaries % generate glossaries
    \IfFileExists{glossary.tex}{\input{glossary.tex}}{}
$endif$

\begin{document}
$if(title)$
    $if(beamer)$
        \frame{\titlepage}
    $else$
        % title page
        % \begin{titlepage}
            \maketitle
        % \end{titlepage}
    $endif$
    $if(abstract)$
        \begin{abstract}
            $abstract$
        \end{abstract}
    $endif$
$endif$
$for(include-before)$
    $include-before$
$endfor$
$if(toc)$
    $if(toc-title)$
        \renewcommand*\contentsname{$toc-title$}
    $endif$
    $if(beamer)$
        \begin{frame}
            $if(toc-title)$
                \frametitle{$toc-title$}
            $endif$
            \tableofcontents[hideallsubsections]
        \end{frame}
    $else$
        {
        $if(colorlinks)$
            \hypersetup{linkcolor=$if(toccolor)$$toccolor$$else$Maroon$endif$}
        $endif$
        \setcounter{tocdepth}{$toc-depth$}
        \tableofcontents
        }
    $endif$
$endif$
$if(lot)$
    \listoftables
$endif$
$if(lof)$
    \listoffigures
$endif$
$if(glossaries)$
    \printnoidxglossaries
$endif$
\clearpage
$body$
$if(natbib)$
    $if(bibliography)$
        $if(biblio-title)$
            $if(book-class)$
                \renewcommand\bibname{$biblio-title$}
            $else$
                \renewcommand\refname{$biblio-title$}
            $endif$
        $endif$
        $if(beamer)$
            \begin{frame}[allowframebreaks]{$biblio-title$}
                \bibliographytrue
        $endif$
        \bibliography{$for(bibliography)$$bibliography$$sep$,$endfor$}
        $if(beamer)$
            \end{frame}
        $endif$
    $endif$
$endif$
$if(biblatex)$
    $if(beamer)$
        \begin{frame}[allowframebreaks]{$biblio-title$}
            \bibliographytrue
            \printbibliography[heading=none]
        \end{frame}
    $else$
        \printbibliography$if(biblio-title)$[title=$biblio-title$]$endif$
    $endif$
$endif$
$for(include-after)$
    $include-after$
$endfor$
\end{document}
